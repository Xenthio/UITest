@namespace SimpleDesktopApp
@using System
@using System.Collections.Generic
@using Sandbox.UI
@attribute [StyleSheet("/themes/Avalazor.Defaults.scss")]
@attribute [StyleSheet("/themes/XGUI/DefaultStyles/OliveGreen.scss")]
@attribute [StyleSheet("MainApp.scss")]

<div class="main-app">
    <div class="controls-demo-window">
        <!-- Main Window with test controls -->
        <div class="main-window window">
            <div class="titlebar">
                <div class="titleelements">
                    <div class="titlelabel">Controls Demo - @currentTheme</div>
                    <div class="titlespacer"></div>
                    <button class="control closebutton" @onclick="@(() => Console.WriteLine("Close clicked"))">Ã—</button>
                </div>
                <div class="titlebackground"></div>
            </div>
            
            <div class="window-content">
                <h2>Sandbox.UI Controls Demo</h2>
                
                <!-- Button tests -->
                <section class="demo-section">
                    <h3>Buttons</h3>
                    <div class="button-group">
                        <button class="button" @onclick="@IncrementCounter">
                            <span class="button-text">Click Count: @clickCount</span>
                        </button>
                        <button class="button" @onclick="@OpenThemeSelector">
                            <span class="button-text">ðŸŽ¨ Open Theme Selector</span>
                        </button>
                        <button class="button disabled">
                            <span class="button-text">Disabled Button</span>
                        </button>
                    </div>
                </section>
                
                <!-- Checkbox tests -->
                <section class="demo-section">
                    <h3>Checkboxes</h3>
                    <div class="checkbox-group">
                        <div class="checkbox @(checkbox1 ? "checked" : "")" @onclick="@(() => checkbox1 = !checkbox1)">
                            <div class="checkpanel">
                                <label class="checklabel">a</label>
                            </div>
                            <label>Enable Feature A</label>
                        </div>
                        <div class="checkbox @(checkbox2 ? "checked" : "")" @onclick="@(() => checkbox2 = !checkbox2)">
                            <div class="checkpanel">
                                <label class="checklabel">a</label>
                            </div>
                            <label>Enable Feature B</label>
                        </div>
                    </div>
                </section>
                
                <!-- Radio button tests -->
                <section class="demo-section">
                    <h3>Radio Buttons</h3>
                    <div class="radiobuttons">
                        <div class="radiobutton @(selectedOption == 1 ? "checked" : "")" @onclick="@(() => selectedOption = 1)">
                            <div class="checkpanel">
                                <label class="checklabel">a</label>
                            </div>
                            <label>Option 1</label>
                        </div>
                        <div class="radiobutton @(selectedOption == 2 ? "checked" : "")" @onclick="@(() => selectedOption = 2)">
                            <div class="checkpanel">
                                <label class="checklabel">a</label>
                            </div>
                            <label>Option 2</label>
                        </div>
                        <div class="radiobutton @(selectedOption == 3 ? "checked" : "")" @onclick="@(() => selectedOption = 3)">
                            <div class="checkpanel">
                                <label class="checklabel">a</label>
                            </div>
                            <label>Option 3</label>
                        </div>
                    </div>
                    <p>Selected: Option @selectedOption</p>
                </section>
                
                <!-- Group box test -->
                <section class="demo-section">
                    <div class="groupbox">
                        <label class="groupbox-title">Settings Group</label>
                        <div class="groupbox-content">
                            <p>This is a grouped section of controls</p>
                            <div class="checkbox @(groupCheckbox ? "checked" : "")" @onclick="@(() => groupCheckbox = !groupCheckbox)">
                                <div class="checkpanel">
                                    <label class="checklabel">a</label>
                                </div>
                                <label>Enable Advanced Options</label>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
        
        <!-- Theme Selector Window (shown when opened) -->
        @if (showThemeSelector)
        {
            <div class="theme-selector-window window" style="position: absolute; left: 100px; top: 100px; width: 500px;">
                <div class="titlebar">
                    <div class="titleelements">
                        <div class="titlelabel">XGUI Theme Selector</div>
                        <div class="titlespacer"></div>
                        <button class="control closebutton" @onclick="@CloseThemeSelector">Ã—</button>
                    </div>
                    <div class="titlebackground"></div>
                </div>
                
                <div class="window-content">
                    <h3>Select Theme</h3>
                    <p>Choose a theme to apply globally to all windows:</p>
                    
                    <div class="theme-list">
                        @foreach (var theme in GetAvailableThemes())
                        {
                            <div class="theme-item @(currentTheme == theme.Name ? "selected" : "")" 
                                 @onclick="@(() => ApplyTheme(theme))">
                                <strong>@theme.Name</strong>
                                <p>@theme.Description</p>
                            </div>
                        }
                    </div>
                    
                    <div class="theme-info">
                        <p><strong>Current Theme:</strong> @currentTheme</p>
                        <p><em>Note: Theme switching is shown visually. Full dynamic theme reload would require StyleSheet.Remove/Add API implementation.</em></p>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

@code {
    private int clickCount = 0;
    private bool checkbox1 = false;
    private bool checkbox2 = true;
    private int selectedOption = 1;
    private bool groupCheckbox = false;
    private bool showThemeSelector = false;
    private string currentTheme = "OliveGreen";
    
    private void IncrementCounter()
    {
        clickCount++;
        Console.WriteLine($"Button clicked! Count: {clickCount}");
    }
    
    private void OpenThemeSelector()
    {
        showThemeSelector = true;
        Console.WriteLine("Opening theme selector");
    }
    
    private void CloseThemeSelector()
    {
        showThemeSelector = false;
        Console.WriteLine("Closing theme selector");
    }
    
    private class ThemeInfo
    {
        public string Name { get; set; } = "";
        public string Description { get; set; } = "";
        public string Path { get; set; } = "";
    }
    
    private List<ThemeInfo> GetAvailableThemes()
    {
        return new List<ThemeInfo>
        {
            new() { Name = "OliveGreen", Description = "Half-Life 2 / Valve style", Path = "/themes/XGUI/DefaultStyles/OliveGreen.scss" },
            new() { Name = "Computer95", Description = "Windows 95 classic look", Path = "/themes/XGUI/DefaultStyles/Computer95.scss" },
            new() { Name = "ComputerXP", Description = "Windows XP Luna theme", Path = "/themes/XGUI/DefaultStyles/ComputerXP.scss" },
            new() { Name = "Computer7", Description = "Windows 7 Aero-inspired", Path = "/themes/XGUI/DefaultStyles/Computer7.scss" },
            new() { Name = "Computer11", Description = "Windows 11 modern design", Path = "/themes/XGUI/DefaultStyles/Computer11.scss" },
            new() { Name = "Derma", Description = "Garry's Mod default UI", Path = "/themes/XGUI/DefaultStyles/Derma.scss" },
            new() { Name = "SboxDark", Description = "s&box dark theme", Path = "/themes/XGUI/DefaultStyles/SboxDark.scss" },
            new() { Name = "Vapour", Description = "Steam-inspired interface", Path = "/themes/XGUI/DefaultStyles/Vapour.scss" },
            new() { Name = "IMGUI", Description = "Dear ImGui style", Path = "/themes/XGUI/DefaultStyles/IMGUI.scss" },
            new() { Name = "Simple", Description = "Clean, minimal design", Path = "/themes/XGUI/DefaultStyles/Simple.scss" },
            new() { Name = "ThinGrey", Description = "Lightweight grey theme", Path = "/themes/XGUI/DefaultStyles/ThinGrey.scss" },
        };
    }
    
    private void ApplyTheme(ThemeInfo theme)
    {
        currentTheme = theme.Name;
        Console.WriteLine($"Applying theme: {theme.Name}");
        Console.WriteLine($"Theme path: {theme.Path}");
        Console.WriteLine("Note: Full dynamic theme switching requires StyleSheet API implementation");
        
        // In a real implementation, this would use:
        // StyleSheet.Remove(oldThemeSheet);
        // var newTheme = StyleSheet.FromFile(theme.Path);
        // StyleSheet.Add(newTheme);
    }
    
    protected override void OnAfterTreeRender(bool firstTime)
    {
        if (firstTime)
        {
            Console.WriteLine("MainApp initialized - Controls Demo with XGUI theme: " + currentTheme);
        }
    }
}
